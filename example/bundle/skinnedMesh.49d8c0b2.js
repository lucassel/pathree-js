var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},a=e.parcelRequire5b70;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in n){var a=n[e];delete n[e];var r={id:e,exports:{}};return t[e]=r,a.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){n[e]=t},e.parcelRequire5b70=a);var r=a("ilwiq"),i=a("RPVlj"),o=a("7lx9d"),s=a("5Rd1x"),l=a("4CEV9"),d=a("891vQ"),u=a("kp7Te"),c=a("jiuw3");r=a("ilwiq");let m,p,w,h,g,f,x,b,v,y,M=0;const F={environmentIntensity:1,bounces:3,samplesPerFrame:1,resolutionScale:1/window.devicePixelRatio,tiles:1,autoPause:!0,pause:!1,continuous:!1};function P(e){v.action.paused=e,F.pause=e,e&&C()}function E(e){return(new o.GLTFLoader).setMeshoptDecoder(u.MeshoptDecoder).loadAsync(e).then((e=>{e.scene.traverse((e=>{e.material&&(e.material.metalness=0,e.material.map=null)}));const t=e.animations,n=new r.AnimationMixer(e.scene),a=n.clipAction(t[0]);a.play(),a.paused=F.pause;const i=new r.Group;i.add(e.scene);const o=function(e){const t=new Uint8Array(e*e*4);for(let n=0;n<e;n++)for(let a=0;a<e;a++){const r=2*(n/(e-1)-.5),i=2*(a/(e-1)-.5);let o=Math.max(Math.min(1-Math.sqrt(r**2+i**2),1),0);o=o**2,o=Math.min(o,1);const s=a*e+n;t[4*s+0]=255,t[4*s+1]=255,t[4*s+2]=255,t[4*s+3]=255*o}const n=new r.DataTexture(t,e,e);return n.format=r.RGBAFormat,n.type=r.UnsignedByteType,n.minFilter=r.LinearFilter,n.magFilter=r.LinearFilter,n.wrapS=r.RepeatWrapping,n.wrapT=r.RepeatWrapping,n.needsUpdate=!0,n}(2048),s=new r.Mesh(new r.PlaneBufferGeometry,new r.MeshStandardMaterial({map:o,transparent:!0,color:14540253,roughness:.025,metalness:1}));s.scale.setScalar(50),s.rotation.x=-Math.PI/2,s.position.y=.075,i.add(s);return{scene:i,sceneGenerator:new l.DynamicPathTracingSceneGenerator(i),mixer:n,action:a}}))}function R(){const e=window.innerWidth,t=window.innerHeight,n=F.resolutionScale,a=window.devicePixelRatio;h.setSize(e*n*a,t*n*a),h.reset(),m.setSize(e,t),m.setPixelRatio(window.devicePixelRatio*n),g.aspect=e/t,g.updateProjectionMatrix()}function C(){const{scene:e,sceneGenerator:t}=v,n=t.generate(e);w=n;const{bvh:a,textures:r,materials:i}=n,o=a.geometry,s=h.material;s.bvh.updateFrom(a),s.normalAttribute.updateFrom(o.attributes.normal),s.tangentAttribute.updateFrom(o.attributes.tangent),s.uvAttribute.updateFrom(o.attributes.uv),s.materialIndexAttribute.updateFrom(o.attributes.materialIndex),s.textures.setTextures(m,2048,2048,r),s.materials.updateFrom(i,r),h.reset()}function S(){requestAnimationFrame(S);const e=Math.min(b.getDelta(),.03);if(v.mixer.update(e),v.scene.updateMatrixWorld(),F.autoPause?(M+=e,(!F.pause&&M>=2.5||F.pause&&M>=5)&&(P(!F.pause),M=0)):M=0,F.pause||F.continuous){!F.pause&&F.continuous&&C(),h.material.materials.updateFrom(w.materials,w.textures),h.material.environmentIntensity=F.environmentIntensity,h.material.environmentBlur=.35,h.material.bounces=F.bounces,g.updateMatrixWorld();for(let e=0,t=F.samplesPerFrame;e<t;e++)h.update();h.samples<1&&m.render(x,g),m.autoClear=!1,f.render(m),m.autoClear=!0,y.innerText=`Samples: ${Math.floor(h.samples)}`}else m.render(x,g)}window.innerWidth/window.innerHeight<.65&&(F.resolutionScale*=.5,F.tiles=2),async function(){m=new r.WebGLRenderer({antialias:!0}),m.toneMapping=r.ACESFilmicToneMapping,m.outputEncoding=r.sRGBEncoding,document.body.appendChild(m.domElement),x=new r.Scene,g=new r.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.025,500),g.position.set(5.5,3.5,7.5),h=new l.PathTracingRenderer(m),h.camera=g,h.material=new l.PhysicalPathTracingMaterial,h.material.filterGlossyFactor=.25,h.material.setDefine("FEATURE_MIS",0),h.tiles.set(F.tiles,F.tiles),f=new i.FullScreenQuad(new r.MeshBasicMaterial({map:h.target.texture,transparent:!0})),p=new s.OrbitControls(g,m.domElement),p.target.set(-.15,2,-.08),g.lookAt(p.target),p.addEventListener("change",(()=>{h.reset()})),p.update(),y=document.getElementById("samples"),b=new r.Clock;const e=new Promise((e=>{(new d.RGBELoader).load("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/equirectangular/royal_esplanade_1k.hdr",(t=>{const n=new l.BlurredEnvMapGenerator(m),a=n.generate(t,.35);h.material.envMapInfo.updateFrom(a),n.dispose(),x.background=a,x.environment=a,e()}))}));v="#morphtarget"===window.location.hash?await E("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/models/gltf/RobotExpressive/RobotExpressive.glb"):await E("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/trex/scene.gltf");x.add(v.scene),await e,document.getElementById("loading").remove(),R(),window.addEventListener("resize",R);const t=new c.GUI;t.add(F,"tiles",1,4,1).onChange((e=>{h.tiles.set(e,e)})),t.add(F,"samplesPerFrame",1,10,1),t.add(F,"environmentIntensity",0,10).onChange((()=>{h.reset()})),t.add(F,"bounces",1,5,1).onChange((()=>{h.reset()})),t.add(F,"resolutionScale",.1,1).onChange((()=>{R()})),t.add(F,"autoPause").listen(),t.add(F,"pause").onChange((e=>{F.autoPause=!1,P(e)})).listen(),t.add(F,"continuous").onChange((()=>{F.autoPause=!1})),S()}();
//# sourceMappingURL=skinnedMesh.49d8c0b2.js.map
